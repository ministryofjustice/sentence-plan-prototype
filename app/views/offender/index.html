{% extends "layout.html" %}

{% block afterHeader %}
  {% include "includes/key-details.html" %}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">

      {% if planSaved %}
        {{ mojBanner({
          type: 'success',
          text: planSaved,
          iconFallbackText: 'Success'
        }) }} 
      {% endif %}

      <h1 class="govuk-visually-hidden">
        Offender plans: {{ offender.name }}
      </h1>

      <div class="moj-page-header-actions"">
        <div class="moj-page-header-actions__title">
          <h1 class="govuk-heading-l">
            Active plan
          </h1>
        </div>



        {% if not data['plan-status'] %}
      </div>
          <p>There is no active plan.</p>
          {{ govukButton ({
            text: 'Start a new plan',
            href: '/offender/create-plan/summary'
          }) }}



        {% elif data['plan-status'] == 'draft' %}

      </div> 
          <p>There is a draft plan from {{ data | date("D MMMM YYYY") }}.</p>
          {{ govukButton ({
            text: 'View draft',
            href: '/offender/create-plan/check-your-answers'
          }) }}




        {% elif data['plan-status'] == 'saved' %}

        <div class="moj-page-header-actions__actions">
          <div class="moj-button-menu">
            <div class="moj-button-menu__wrapper">

              {{ govukButton ({
                text: 'Print',
                href: '/offender/print/',
                classes: 'govuk-button--secondary moj-button-menu__item moj-page-header-actions__action'
              }) }}

              {{ govukButton ({
                text: 'Close plan',
                href: '/offender/close',
                classes: 'govuk-button--secondary moj-button-menu__item moj-page-header-actions__action'
              }) }}

            </div>
          </div>
        </div>
      </div> 

    {# </div>
    <div class="govuk-grid-column-two-thirds"> #}


        <h3 class="govuk-heading-m govuk-visually-hidden">
          Plan summary
        </h3>

        <dl class="govuk-summary-list govuk-!-margin-bottom-9">
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">
              Diversity
            </dt>
            <dd class="govuk-summary-list__value">
              {{ data['diversity'] | nl2br | safe }}
            </dd>
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">
              Their summary
            </dt>
            <dd class="govuk-summary-list__value">
              {{ data['offender-summary'] | nl2br | safe }}
            </dd>
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">
              Practitioner&rsquo;s comments on plan
            </dt>
            <dd class="govuk-summary-list__value">
              {{ data['practitioner-comment'] | nl2br | safe }}
            </dd>
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">
              Their comments on plan
            </dt>
            <dd class="govuk-summary-list__value">
              {{ data['offender-comment'] | nl2br | safe }}
            </dd>
          </div>
        </dl>



        <h3 class="govuk-heading-m govuk-!-margin-bottom-1">
          Goals
        </h3>

        <div class="filters govuk-!-margin-bottom-4">
          {{ govukCheckboxes ({
            idPrefix: 'js-toggle',
            name: 'show-complete',
            classes: 'govuk-checkboxes--small',
            items: [
            {
              text: 'Show completed goals',
              value: 'Show completed goals'
            }
            ]
          }) }}

          {# <div class="govuk-form-group">
            <label class="govuk-label" for="sort">
              Show need:
            </label>


            <select class="govuk-select" id="sort" name="sort">
            <option value="All">All</option>
            {% for need in offender.needs %}
              <option value="{{ need.type }}">{{ need.type }}</option>
            {% endfor %}
            </select>
          </div> #}
        </div>




        <ul class="govuk-list">
          {% if data['unpaidwork'] %}
            {% include "includes/unpaidwork-card.html" %}
          {% endif %}
          {% if data['goal1-added'] %}
            {% if data['goals-reordered'] == 'true' %}
              {% include "includes/goal2-card.html" %}
              {% include "includes/goal1-card.html" %}
            {% else %} 
              {% include "includes/goal1-card.html" %}
              
              {% if data['goal2-added'] == 'true' %}
                {% include "includes/goal2-card.html" %}
              {% endif %}
            {% endif %}
          {% endif %}
        </ul>

        


        {{ govukButton ({
          text: 'Add another goal',
          href: '#0',
          classes: 'govuk-button--secondary govuk-!-margin-bottom-3'
        }) }}
        {% if data['goal2-added'] %}
          {{ govukButton ({
            text: 'Reorder goals',
            href: '#0',
            classes: 'govuk-button--secondary govuk-!-margin-bottom-3'
          }) }}
        {% endif %}

        

        

      {% endif %} {# plan status #}




      <hr class="govuk-section-break section-break-large">


      <h2 class="govuk-heading-m">
        Previous plans
      </h2>

      <ul class="govuk-list">
        {% if data['plan-closed'] %}
        <li>
          <a class="govuk-link" href="#">Plan closed {{ moment | date("D MMMM YYYY") }}</a>
        </li>
        {% endif %}
        <li>
          <a class="govuk-link" href="#">Plan closed {{ moment | date("subtract", 100, "days") | date("D MMMM YYYY") }}</a>
        </li>
        <li>
          <a class="govuk-link" href="#">Plan closed {{ moment | date("subtract", 211, "days") | date("D MMMM YYYY") }}</a>
        </li>
      </ul>


    </div>
  </div>
{% endblock %}
